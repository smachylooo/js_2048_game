!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var e,r={};function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s=function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.INITIAL_STATE;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),this.status=e.STATUS.idle,this.initialState=t,this.score=0,this.state=this.initialState.map(function(t){return t.slice()})}return t=[{key:"moveLeft",value:function(){if(this.status===e.STATUS.playing){for(var t=this,r=[],n=0;n<this.state.length;n++)!function(e){for(var n=t.state[e].filter(function(t){return t>0}),s=n.length;s<t.state.length;s++)n.push(0);for(var i=0;i<n.length;i++)n[i]===n[i+1]&&(n[i]=n[i]+n[i+1],n[i+1]=0,t.score+=n[i]+n[i+1]);n=n.filter(function(t){return t>0});for(var a=n.length;a<t.state.length;a++)n.push(0);r.push(n)}(n);this.checkSameArr(r)||(this.state=r,this.randomNumber()),this.loseOrWin()}}},{key:"moveRight",value:function(){if(this.status===e.STATUS.playing){for(var t=this,r=[],n=0;n<this.state.length;n++)!function(e){for(var n=t.state[e].filter(function(t){return t>0}),s=n.length;s<t.state.length;s++)n.unshift(0);for(var i=n.length-1;i>0;i--)n[i]===n[i-1]&&(n[i]=n[i]+n[i-1],n[i-1]=0,t.score+=n[i]+n[i-1]);n=n.filter(function(t){return t>0});for(var a=n.length;a<t.state.length;a++)n.unshift(0);r.push(n)}(n);this.checkSameArr(r)||(this.state=r,this.randomNumber()),this.loseOrWin()}}},{key:"moveUp",value:function(){if(this.status===e.STATUS.playing){var t=[];this.funcReverse(t),this.state=t,t=[],this.moveLeft(),this.funcReverse(t),this.state=t}}},{key:"moveDown",value:function(){if(this.status===e.STATUS.playing){var t=[];this.funcReverse(t),this.state=t,t=[],this.moveRight(),this.funcReverse(t),this.state=t}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"restart",value:function(){this.initialState=e.INITIAL_STATE,this.status=e.STATUS.idle,this.state=this.initialState.map(function(t){return t.slice()}),this.score=0}},{key:"start",value:function(){this.status=e.STATUS.playing,this.randomNumber(),this.randomNumber()}},{key:"randomNumber",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var r=0;r<this.state[e].length;r++)0===this.state[e][r]&&t.push({row:e,col:r});if(0!==t.length){var n=Math.floor(Math.random()*t.length),s=t[n],i=s.row,a=s.col;this.state[i][a]=Math.floor(10*Math.random())+1>8?4:2}}},{key:"loseOrWin",value:function(){for(var t=!1,r=!1,n=0;n<this.state.length;n++)for(var s=0;s<this.state[n].length;s++){if(2048===this.state[n][s]){this.status=e.STATUS.win;return}0===this.state[n][s]&&(t=!0),s<this.state[n].length-1&&this.state[n][s]===this.state[n][s+1]&&(r=!0),n<this.state.length-1&&this.state[n][s]===this.state[n+1][s]&&(r=!0)}t||r||(this.status=e.STATUS.lose)}},{key:"checkSameArr",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state;if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(Array.isArray(t[r])&&Array.isArray(e[r])){if(!this.checkSameArr(t[r],e[r]))return!1}else if(t[r]!==e[r])return!1;return!0}},{key:"funcReverse",value:function(t){for(var e=0;e<this.state.length;e++){for(var r=[],n=0;n<this.state[e].length;n++)r.push(this.state[n][e]);t.push(r)}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}();n(s,"STATUS",{idle:"idle",playing:"playing",win:"win",lose:"lose"}),n(s,"INITIAL_STATE",[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);var i=new(r=s),a=document.querySelector(".start"),o=document.querySelector(".game-score"),l=function(e){if(Array.isArray(e))return t(e)}(e=document.querySelectorAll(".field-row"))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,r){if(e){if("string"==typeof e)return t(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),h=document.querySelector(".message-start"),u=document.querySelector(".message-lose"),c=document.querySelector(".message-win");function f(t){for(var e=0;e<l.length;e++)for(var r=0;r<l[e].children.length;r++)l[e].children[r].textContent="",l[e].children[r].className="field-cell",t[e][r]>0&&(l[e].children[r].textContent=t[e][r],l[e].children[r].className="field-cell field-cell--".concat(t[e][r]))}a.addEventListener("click",function(){a.classList.contains("start")?(a.textContent="Restart",a.classList.remove("start"),a.classList.add("restart"),i.start(),f(i.getState()),o.textContent=i.getScore(),h.classList.add("hidden")):(a.textContent="Start",a.classList.remove("restart"),a.classList.add("start"),i.restart(),f(i.getState()),o.textContent=i.getScore(),h.classList.remove("hidden")),u.classList.add("hidden")}),document.addEventListener("keydown",function(t){var e;switch(t.key){case"ArrowUp":i.moveUp();break;case"ArrowDown":i.moveDown();break;case"ArrowLeft":i.moveLeft();break;case"ArrowRight":i.moveRight()}f(i.getState()),o.textContent=i.getScore(),(e=i.getStatus())===r.STATUS.lose&&u.classList.remove("hidden"),e===r.STATUS.win&&c.classList.remove("hidden")})}();
//# sourceMappingURL=index.fe3a944f.js.map
