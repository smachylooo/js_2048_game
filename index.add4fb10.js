var t={};class e{static STATUS={idle:"idle",playing:"playing",win:"win",lose:"lose"};static INITIAL_STATE=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];constructor(t=e.INITIAL_STATE){this.status=e.STATUS.idle,this.initialState=t,this.score=0,this.state=this.initialState.map(t=>t.slice())}moveLeft(){if(this.status===e.STATUS.playing){let t=[];for(let e=0;e<this.state.length;e++){let s=this.state[e].filter(t=>t>0);for(let t=s.length;t<this.state.length;t++)s.push(0);for(let t=0;t<s.length;t++)s[t]===s[t+1]&&(s[t]=s[t]+s[t+1],s[t+1]=0,this.score+=s[t]+s[t+1]);s=s.filter(t=>t>0);for(let t=s.length;t<this.state.length;t++)s.push(0);t.push(s)}this.checkSameArr(t)||(this.state=t,this.randomNumber()),this.loseOrWin()}}moveRight(){if(this.status===e.STATUS.playing){let t=[];for(let e=0;e<this.state.length;e++){let s=this.state[e].filter(t=>t>0);for(let t=s.length;t<this.state.length;t++)s.unshift(0);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]=s[t]+s[t-1],s[t-1]=0,this.score+=s[t]+s[t-1]);s=s.filter(t=>t>0);for(let t=s.length;t<this.state.length;t++)s.unshift(0);t.push(s)}this.checkSameArr(t)||(this.state=t,this.randomNumber()),this.loseOrWin()}}moveUp(){if(this.status===e.STATUS.playing){let t=[];this.funcReverse(t),this.state=t,t=[],this.moveLeft(),this.funcReverse(t),this.state=t}}moveDown(){if(this.status===e.STATUS.playing){let t=[];this.funcReverse(t),this.state=t,t=[],this.moveRight(),this.funcReverse(t),this.state=t}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}restart(){this.initialState=e.INITIAL_STATE,this.status=e.STATUS.idle,this.state=this.initialState.map(t=>t.slice()),this.score=0}start(){this.status=e.STATUS.playing,this.randomNumber(),this.randomNumber()}randomNumber(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({row:e,col:s});if(0===t.length)return;let e=Math.floor(Math.random()*t.length),{row:s,col:i}=t[e];this.state[s][i]=Math.floor(10*Math.random())+1>8?4:2}loseOrWin(){let t=!1,s=!1;for(let i=0;i<this.state.length;i++)for(let r=0;r<this.state[i].length;r++){if(2048===this.state[i][r]){this.status=e.STATUS.win;return}0===this.state[i][r]&&(t=!0),r<this.state[i].length-1&&this.state[i][r]===this.state[i][r+1]&&(s=!0),i<this.state.length-1&&this.state[i][r]===this.state[i+1][r]&&(s=!0)}t||s||(this.status=e.STATUS.lose)}checkSameArr(t,e=this.state){if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(Array.isArray(t[s])&&Array.isArray(e[s])){if(!this.checkSameArr(t[s],e[s]))return!1}else if(t[s]!==e[s])return!1;return!0}funcReverse(t){for(let e=0;e<this.state.length;e++){let s=[];for(let t=0;t<this.state[e].length;t++)s.push(this.state[t][e]);t.push(s)}}}const s=new(t=e),i=document.querySelector(".start"),r=document.querySelector(".game-score"),a=[...document.querySelectorAll(".field-row")],h=document.querySelector(".message-start"),l=document.querySelector(".message-lose"),n=document.querySelector(".message-win");function o(t){for(let e=0;e<a.length;e++)for(let s=0;s<a[e].children.length;s++)a[e].children[s].textContent="",a[e].children[s].className="field-cell",t[e][s]>0&&(a[e].children[s].textContent=t[e][s],a[e].children[s].className=`field-cell field-cell--${t[e][s]}`)}i.addEventListener("click",()=>{i.classList.contains("start")?(i.textContent="Restart",i.classList.remove("start"),i.classList.add("restart"),s.start(),o(s.getState()),r.textContent=s.getScore(),h.classList.add("hidden")):(i.textContent="Start",i.classList.remove("restart"),i.classList.add("start"),s.restart(),o(s.getState()),r.textContent=s.getScore(),h.classList.remove("hidden")),l.classList.add("hidden")}),document.addEventListener("keydown",e=>{var i;switch(e.key){case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown();break;case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight()}o(s.getState()),r.textContent=s.getScore(),(i=s.getStatus())===t.STATUS.lose&&l.classList.remove("hidden"),i===t.STATUS.win&&n.classList.remove("hidden")});
//# sourceMappingURL=index.add4fb10.js.map
